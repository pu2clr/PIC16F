# PIC C Journey

Developing in C instead of assembly offers several compelling advantages for PIC microcontroller projects:

1. **Ease of Use**: C is more straightforward to learn and use. Its higher-level abstractions make it easier to write, read, and maintain code.

2. **Portability**: Code written in C can often be used across different types of microcontrollers with minimal changes. This is not the case with assembly, which is specific to each processor.

3. **Development Speed**: Writing in C is generally faster than in assembly, allowing for quicker prototyping and project completion.

4. **Advanced Features**: Modern C compilers for PIC microcontrollers include optimizations that rival assembly in efficiency, reducing the performance gap.

5. **Rich Libraries and Tools**: C has a vast ecosystem of libraries and development tools, which can significantly speed up development and add functionality.

6. **Maintainability**: C code is easier to understand and modify, making it preferable for larger or longer-term projects.

In essence, while assembly offers precision control, the benefits of C—such as its portability, ease of use, and development speed—make it a strong choice for a wide range of applications.




## C/XC8 optimization levels


In the MPLAB X environment by Microchip, used for developing applications for PIC microcontrollers among others, the C compiler offers different optimization levels that adjust how code is compiled to enhance performance or reduce code size. These optimization levels are specified by numbers (0, 1, 2, 3) and a letter ('s'), each with its own characteristics and purposes. Here's a summary of each optimization level:

### Level 0 (O0)
* **Description**: This is the default optimization level when optimization is turned off.
* **Characteristics**: The compiler performs a quick compilation without focusing on optimization, resulting in code that is easier to debug because the structure of the generated code closely matches the source code.

### Level 1 (O1)
* **Description**: This level seeks a balance between compilation time and optimization, applying optimizations that do not require significant compilation time.
* **Characteristics**: It carries out basic code optimizations to improve speed and/or reduce code size without significantly increasing compilation time. This level may include optimizations such as dead code elimination and loop optimization.

### Level 2 (O2)
* **Description**: At this level, the compiler applies more aggressive optimizations that can increase compilation time but aim for better code performance at the expense of compilation time.
* **Characteristics**: Includes all optimizations from level O1, plus more advanced ones like function call optimizations, better register allocation, and pipeline optimizations, aiming for faster program execution.

### Level 3 (O3)
* **Description**: O3 is the highest level of optimization, focused on maximizing program speed.
* **Characteristics**: Besides the optimizations from level O2, this level may restructure loops, unroll loops, and use more complex algorithms for optimizations. Code size may increase as a result of these optimizations.

### Level 's' (Os)
* **Description**: This level is specific to size optimization, aiming to reduce the code size as much as possible.
* **Characteristics**: The focus is on minimizing the final code size, which can be crucial for devices with limited memory. This might include aggressive dead code elimination, merging of similar functions, and other size reduction techniques.

Each optimization level serves a specific purpose, and the choice of the appropriate level depends on the project goals, whether to maximize speed, minimize code size, or find a balance between both. Adjusting the optimization level can significantly impact the performance and size of the code generated by the compiler.


### IMPORTANT: 

In most of the C implementations carried out in this repository, the optimization option used was 's' (Os). The following figure illustrates how to configure this option in MPLAB X. It is important to note that, in rare situations, the optimization option may improperly alter the program's behavior, leading to an unexpected result. However, the 's' (Os)  option proved to be stable in all experiments in this repository.

![C/XC8 compiler optimization setup](../../images/c_compiler_optimization.png)


### Compiler Advisor


The "Compiler Advisor" in MPLAB X IDE is a tool designed to assist developers in optimizing code for Microchip's PIC and dsPIC microcontrollers. It provides recommendations on how to improve code efficiency in terms of speed and size by analyzing the source code and compilation settings. This is particularly useful in embedded systems where resources like memory and processing speed are limited.

#### When can the "Compiler Advisor" be useful?

1. **Performance Optimization:** If you're trying to speed up a critical section of the code, the "Compiler Advisor" can suggest changes in how you've written the code or in the compilation options to enhance execution speed.

2. **Code Size Reduction:** For applications where memory is scarce, reducing the binary code size is crucial. The "Compiler Advisor" can recommend techniques and changes in code or compilation options to decrease the space your program occupies.

3. **Identification of Potential Code Issues:** Beyond optimization, this tool can help identify coding practices that may lead to errors or undesired behavior, allowing for proactive correction.

4. **Exploring Compiler Features:** The "Compiler Advisor" can introduce compilation options and compiler features that you might not be aware of but can significantly benefit your project.

5. **Learning and Code Improvement:** By providing specific recommendations, the tool serves as a learning medium, teaching best programming practices for microcontrollers.

### How to Use It?

To use the "Compiler Advisor," you typically need to have a project open in MPLAB X IDE. From there, you can access the tool through the menu or tool panel, select the section of code you wish to analyze, and then run the analysis. The IDE will then present a list of suggestions and insights on how to improve the code.

In summary, the "Compiler Advisor" is a valuable tool for developers looking to optimize their microcontroller projects in terms of both performance and memory efficiency while also improving the overall quality of the code.

The image below shows how you can use this tool. 

![Compiler Advisor](../../images/c_compiler_advisor_analysis.png)
